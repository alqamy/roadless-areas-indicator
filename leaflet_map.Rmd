---
title: "Roadless lands by ecoregion"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(leaflet)
library(bcmaps)
library(sf)
library(dplyr)
library(rmapshaper)

plot_list <- readRDS("tmp/plotlist.rds")

map_list <- lapply(plot_list, "[[", "map")[-1]

ecoreg <- ecoregions() %>% 
  ms_simplify() %>% 
  st_intersection(bc_bound()) %>% 
  st_transform(4326) %>% 
  group_by(ECOREGION_NAME) %>% 
  summarize()

labels <- sprintf(
  "<strong>%s</strong>",
  tools::toTitleCase(tolower(ecoreg$ECOREGION_NAME))
) %>% lapply(htmltools::HTML)
```


```{r leaflet map, echo=FALSE}
leaflet(ecoreg) %>% 
  setView(lng = -126.5, lat = 54.5, zoom = 5) %>% 
  addProviderTiles("OpenStreetMap.BlackAndWhite") %>% 
  addPolygons(color = "#00441b", fillColor = "#006d2c",
              weight = 1, fillOpacity = 0.2,
              highlightOptions = highlightOptions(fillOpacity = 0.6,
                                                  weight = 2,
                                                  bringToFront = TRUE), 
              label = labels, 
              popup = mapview::popupGraph(map_list, type = "png"))
```

```{r mapview map, echo=FALSE}
library(mapview)
mapView(ecoreg, alpha.regions = 0.2, 
        highlight = highlightOptions(fillOpacity = 0.6,
                                                  weight = 2,
                                                  bringToFront = TRUE))
```

